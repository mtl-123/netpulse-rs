# ════════════════════════════════════════════════════════════
# 网络连通性监控系统配置 v2.1
# 说明: 复制 [[device]] 块即可添加新设备，无需修改代码
# ════════════════════════════════════════════════════════════

# ── 全局设置 ────────────────────────────────────────────────
[settings]
# 检测轮询间隔（秒）
interval = 15
# 单次 TCP 连接超时（秒）
timeout = 3
# 同一设备告警冷却时间（秒），避免刷屏
alert_cooldown = 300
# 企业微信机器人 Webhook（支持 ${ENV_VAR} 环境变量替换）
webhook = "https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=19bacb0b-b4f1-44ae-8156-f7dc26ea0dfd"
# 日志级别: debug | info | warn | error
log_level = "info"
# ✅ 新增：最大并发连接数（根据服务器性能调整）
max_concurrent_connections = 100

# ── 设备监控列表（扁平结构，添加设备只需复制 [[device]]）───

# 【数据库组】
[[device]]
id = "redis-master-01"
name = "Redis 主节点"
group = "database"
priority = "critical"
ips = [
  "192.168.1.133",
  "192.168.1.128"
]
os = "linux"
location = "机房/机柜/机架"
# 检测项: port=端口, name=显示名称(可选)
checks = [{ port = 6388, name = "Redis服务" }]

# [[device]]
# id = "redis-slave-01"
# name = "Redis 从节点"
# group = "database"
# priority = "high"
# ips = ["192.168.1.128"]
# os = "linux"
# location = "PVE-115/虚拟机"
# checks = [{ port = 6388, name = "Redis服务" }]

# 【物理服务器 - 货架区】
[[device]]
id = "shelf-srv-01"
name = "货架服务器 01"
group = "physical"
priority = "medium"
ips = [
  "192.168.1.37",
  "192.168.1.240",
  "192.168.1.8",
  "192.168.1.88",
  "192.168.1.120",
  "192.168.1.177",
  "192.168.1.20",
  "192.168.1.130",
  "192.168.1.2",
  "192.168.1.149",
  "192.168.1.70",
  "192.168.1.150",
  "192.168.1.30",
  "192.168.1.157",
  "192.168.1.89",
  "192.168.1.135",
  "192.168.1.159",
  "192.168.1.46",
]
os = "linux"
location = "货架/A区/01"
checks = [
  { port = 22, name = "SSH" },
  { port = 50022, name = "备用SSH" },
  { port = 3389, name = "windows" }
]

# [[device]]
# id = "shelf-srv-02"
# name = "货架服务器 02"
# group = "physical"
# priority = "medium"
# ips = ["192.168.1.25"]
# os = "linux"
# location = "货架/A区/02"
# checks = [{ port = 50022, name = "备用SSH" }]

[[device]]
id = "shelf-srv-03"
name = "货架服务器 03(Win)"
group = "physical"
priority = "medium"
ips = [
  "192.168.1.125",
  "192.168.1.115",
  "192.168.1.129",
  "192.168.1.151",
  "192.168.1.124",
  "192.168.1.25",
  "192.168.1.35",
  "192.168.1.155",
  "192.168.1.190",
  "192.168.1.140",
  "192.168.1.135",
  "192.168.1.149",
  "192.168.1.158",
  "192.168.1.137",
  "192.168.1.122",
  "192.168.1.123",
]
os = "windows"
location = "货架/A区/03"
checks = [
  { port = 3389, name = "RDP" },
  { port = 50022, name = "SSH" },
  { port = 22, name = "SSH" }
]

# # 【虚拟机服务器】
# [[device]]
# id = "vm-app-01"
# name = "应用虚拟机 01"
# group = "virtual"
# priority = "medium"
# ips = ["192.168.1.11"]
# os = "linux"
# location = "ESXi-Cluster-01"
# checks = [
#   { port = 22, name = "SSH" },
#   { port = 80, name = "HTTP" }
# ]

# [[device]]
# id = "vm-app-02"
# name = "应用虚拟机 02"
# group = "virtual"
# priority = "medium"
# ips = ["192.168.1.18"]
# os = "linux"
# location = "ESXi-Cluster-01"
# checks = [
#   { port = 22, name = "SSH" },
#   { port = 443, name = "HTTPS" }
# ]

# [[device]]
# id = "vm-win-01"
# name = "Windows 虚拟机 01"
# group = "virtual"
# priority = "medium"
# ips = ["192.168.1.10"]
# os = "windows"
# location = "ESXi-Cluster-02"
# checks = [
#   { port = 3389, name = "RDP" },
#   { port = 50022, name = "SSH" }
# ]

# [[device]]
# id = "vm-win-02"
# name = "Windows 虚拟机 02(双IP)"
# group = "virtual"
# priority = "high"
# # 多 IP: 任一端口通即判定设备正常（故障转移）
# ips = ["192.168.1.128", "192.168.1.22"]
# os = "windows"
# location = "PVE-115"
# checks = [
#   { port = 3389, name = "RDP" },
#   { port = 50022, name = "SSH" }
# ]

# # 【网络设备】
# [[device]]
# id = "core-switch-01"
# name = "核心交换机 01"
# group = "network"
# priority = "critical"
# ips = ["192.168.8.1"]
# os = "network"
# location = "核心机房"
# checks = [
#   { port = 22, name = "SSH" },
#   { port = 443, name = "HTTPS" }
# ]

# [[device]]
# id = "core-switch-02"
# name = "核心交换机 02"
# group = "network"
# priority = "critical"
# ips = ["192.168.8.3"]
# os = "network"
# location = "核心机房"
# checks = [
#   { port = 22, name = "SSH" },
#   { port = 443, name = "HTTPS" }
# ]

# [[device]]
# id = "firewall-01"
# name = "防火墙 01"
# group = "network"
# priority = "critical"
# ips = ["192.168.8.2"]
# os = "network"
# location = "S24 机柜"
# checks = [{ port = 443, name = "管理界面" }]

# # 【NAS 存储】
# [[device]]
# id = "nas-01"
# name = "主 NAS 存储"
# group = "storage"
# priority = "high"
# ips = ["192.168.1.180"]
# os = "linux"
# location = "存储机房"
# checks = [{ port = 15001, name = "管理端口" }]

# [[device]]
# id = "nas-02"
# name = "备 NAS 存储"
# group = "storage"
# priority = "high"
# ips = ["192.168.1.179"]
# os = "linux"
# location = "存储机房"
# checks = [{ port = 5001, name = "管理端口" }]

# # 【业务服务 - 总线】
# [[device]]
# id = "bus-svc-01"
# name = "总线服务 01"
# group = "application"
# priority = "high"
# ips = ["192.168.1.2"]
# os = "linux"
# location = "S25 机柜/01"
# checks = [{ port = 9999, name = "业务端口" }]

# [[device]]
# id = "bus-svc-02"
# name = "总线服务 02"
# group = "application"
# priority = "high"
# ips = ["192.168.1.86"]
# os = "linux"
# location = "S25 机柜/02"
# checks = [{ port = 9999, name = "业务端口" }]

# # 【AI 算法服务】
# [[device]]
# id = "ai-srv-01"
# name = "AI 服务器 01"
# group = "ai"
# priority = "high"
# ips = ["192.168.1.2"]
# os = "linux"
# location = "GPU 机房/01"
# checks = [{ port = 9999, name = "算法端口" }]

# [[device]]
# id = "ai-srv-02"
# name = "AI 服务器 02"
# group = "ai"
# priority = "high"
# ips = ["192.168.1.86"]
# os = "linux"
# location = "GPU 机房/01"
# checks = [{ port = 9999, name = "算法端口" }]

# [[device]]
# id = "ai-srv-03"
# name = "AI 服务器 03(Win)"
# group = "ai"
# priority = "high"
# ips = ["192.168.1.240"]
# os = "windows"
# location = "GPU 机房/02"
# checks = [{ port = 9999, name = "算法端口" }]

# # 【IDC GPU 服务器】
# [[device]]
# id = "idc-gpu-01"
# name = "IDC GPU 服务器 01"
# group = "idc"
# priority = "high"
# ips = ["192.168.2.116"]
# os = "linux"
# location = "GPU 机房/01"
# checks = [{ port = 50022, name = "SSH" }]

# [[device]]
# id = "idc-gpu-02"
# name = "IDC GPU 服务器 02"
# group = "idc"
# priority = "high"
# ips = ["192.168.2.117"]
# os = "linux"
# location = "GPU 机房/01"
# checks = [{ port = 50022, name = "SSH" }]

# ── 快速添加模板（复制下方块，修改字段即可）──────────────────
# [[device]]
# id = "<唯一英文标识>"
# name = "<中文显示名>"
# group = "<分组: database/physical/virtual/network/storage/application/ai/idc>"
# priority = "<优先级: critical/high/medium/low>"
# ips = ["<IP1>", "<IP2>"]  # 支持多 IP，任一通即正常
# os = "<系统: linux/windows/network>"
# location = "<位置描述>"
# checks = [
#   { port = <端口号>, name = "<服务名称>" }
# ]
